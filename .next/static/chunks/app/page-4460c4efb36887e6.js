(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2480:function(){},4951:function(e,t,n){Promise.resolve().then(n.bind(n,1466)),Promise.resolve().then(n.t.bind(n,8173,23))},9084:function(e,t,n){"use strict";n.d(t,{mu:function(){return d},Ts:function(){return N},zm:function(){return S},ST:function(){return E},be:function(){return a},_B:function(){return i},Np:function(){return l},KB:function(){return _},uT:function(){return u},JE:function(){return h},Wn:function(){return I}});var s,i,r="http://157.245.196.187:8080/api/v1/",c=n(6202),o=n(2524);let a="lang",S="ek",u="sid",N=r+"scanner/connectw",d=r+"scanner/connecte",E=r+"scanner/export",h=r+"scanner/uweigh";(s=i||(i={})).HOME="/",s.EXPORT="/export",s.WEIGH="/weigh";let l=new Map([[o.N.Success,c.d.SCAN_SUCCESS],[o.N.Duplicate,c.d.SCAN_DUP],[o.N.InvalidItem,c.d.SCAN_INVALID],[o.N.NoSession,c.d.SCAN_NO_SESSION],[o.N.ItemNotFound,c.d.SCAN_NO_ITEM]]),_=new Map([[o.N.Success,c.d.SCAN_SUCCESS_MESSAGE],[o.N.Duplicate,c.d.SCAN_DUP_MESSAGE],[o.N.InvalidItem,c.d.SCAN_INVALID_MESSAGE],[o.N.NoSession,c.d.SCAN_NO_SESSION_MESSAGE],[o.N.ItemNotFound,c.d.SCAN_NO_ITEM_MESSAGE]]),I=new Set(["packageSeries","po","packageId"])},8571:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}}),(s=i||(i={})).VietNam="vi",s.English="en",s.Chinese="zh";var s,i,r=n(6202);let c="d_l_k";class o{static instance(){return this._instance||(this._instance=new this),this._instance}setLang(e){e&&(this.activeLang=e,localStorage.setItem(c,e))}text(e){if(r.j[e])return r.j[e][this.activeLang];console.info("use invalid text key.",e)}constructor(){let e=localStorage.getItem(c);this.activeLang=e||i.VietNam}}},6202:function(e,t,n){"use strict";var s,i;n.d(t,{d:function(){return s},j:function(){return r}}),(i=s||(s={})).EMPTY="",i.SESSION_EXPIRE="SESSION_EXPIRE",i.GUIDE_SCAN="GUI_SCAN",i.EXPORT="EXPORT",i.WEIGH="WEIGH",i.SCAN_SUCCESS="SCAN_SUCCESS",i.SCAN_DUP="SCAN_DUP",i.SCAN_INVALID="SCAN_INVALID",i.SCAN_NO_SESSION="SCAN_NO_SESSION",i.SCAN_NO_ITEM="SCAN_NO_ITEM",i.SCAN_SUCCESS_MESSAGE="SCAN_SUCCESS_MESSAGE",i.SCAN_DUP_MESSAGE="SCAN_DUP_MESSAGE",i.SCAN_INVALID_MESSAGE="SCAN_INVALID_MESSAGE",i.SCAN_NO_SESSION_MESSAGE="SCAN_NO_SESSION_MESSAGE",i.SCAN_NO_ITEM_MESSAGE="SCAN_NO_ITEM_MESSAGE",i.WEIGH_FIELD_NAME="WEIGH_FIELD_NAME",i.SUBMIT="SUBMIT",i.ERR_RETRY="ERR_RETRY";let r={SESSION_EXPIRE:{vi:"Phi\xean xử l\xfd đ\xe3 hết hạn.",en:"The session has expired.",zh:"会话已过期"},GUI_SCAN:{vi:"Đưa camera tới QR code để qu\xe9t.",en:"Scan the QR code with your camera.",zh:"使用相机扫描 QR 码"},WEIGH:{vi:"C\xc2N H\xc0NG",en:"WEIGH",zh:"衡量"},EXPORT:{vi:"XUẤT H\xc0NG",en:"EXPORT",zh:"輸出"},SCAN_SUCCESS:{vi:"QU\xc9T TH\xc0NH C\xd4NG",en:"SCAN SUCCESS",zh:"掃描碼成功"},SCAN_DUP:{vi:"QU\xc9T TR\xd9NG",en:"Duplicated",zh:"重複的"},SCAN_INVALID:{vi:"QU\xc9T SAI PHI\xcaN",en:"SCAN_INVALID",zh:"SCAN_INVALID"},SCAN_NO_SESSION:{vi:"KH\xd4NG C\xd3 PHI\xcaN",en:"No session",zh:"沒有會話處理"},SCAN_NO_ITEM:{vi:"SANE PHẨM KH\xd4NG TỒN TẠI",en:"The item does not exist",zh:"此產品不存在"},SCAN_SUCCESS_MESSAGE:{vi:"Qu\xe9t th\xe0nh c\xf4ng",en:"SCAN SUCCESS",zh:"掃描碼成功"},SCAN_DUP_MESSAGE:{vi:"Sản phẩm n\xe0y đ\xe3 được qu\xe9t!",en:"This item has already been scanned",zh:"該商品已掃描"},SCAN_INVALID_MESSAGE:{vi:"Sản phẩm n\xe0y kh\xf4ng nằm trong phi\xean",en:"This product is not available in session!",zh:"該產品在會話中不可用"},SCAN_NO_SESSION_MESSAGE:{vi:"Phi\xean xử l\xfd n\xe0y kh\xf4ng tồn tại!",en:"Session does not exist",zh:"會話不存在"},SCAN_NO_ITEM_MESSAGE:{vi:"Sản phẩm n\xe0y kh\xf4ng tồn tại!",en:"This item does not exist",zh:"此產品不存在"},WEIGH_FIELD_NAME:{vi:"C\xe2n nặng",en:"weight",zh:"重量"},SUBMIT:{vi:"Nhập",en:"Submit",zh:"輸入資料"},ERR_RETRY:{vi:"C\xf3 lỗi, thử lại sau",en:"Error, retry later",zh:"錯誤，稍後重試"}}},1066:function(e,t,n){"use strict";n.d(t,{U:function(){return E}});var s=n(9084),i=n(8571),r=n(6202),c=n(54),o=n(4401);let{AES:a,enc:S}=n(8110);class u{init(e){this.encryptKey=e}aesEncrypt(e){return a.encrypt(JSON.stringify(e),this.encryptKey).toString()}aesDecrypt(e){return 0==Object.keys(e).length?e:JSON.parse(a.decrypt(e,this.encryptKey).toString(S.Utf8))}aesEncryptUseKey(e,t){return a.encrypt(JSON.stringify(t),e).toString()}aesDecryptUseKey(e,t){return JSON.parse(a.decrypt(t,e).toString(S.Utf8))}constructor(){this.encryptKey=""}}let N=new u;var d=n(2524);class E{static instance(){return this._instance||(this._instance=new this),this._instance}initSession(e,t,n){this.endpoint=e,this.sessionId=t,N.init(n)}getFullData(e){return new Promise(t=>{let n=e=>{this.lastData=e,t(e)};return""==this.endpoint?(console.log("endpoint not set, use default"),n(e)):fetch(this.endpoint+"?sid=".concat(this.sessionId),{method:"post",headers:{"Content-Type":"text/plain"},body:N.aesEncrypt({subId:e})}).then(async e=>{let t=await e.json(),s=t.error_code==o.jK.SessionNotFound?t.data:N.aesDecrypt(t.data);switch(s.status){case d.N.Success:case d.N.Duplicate:case d.N.InvalidItem:case d.N.ItemNotFound:n(s);break;case d.N.NoSession:throw Error("No session")}}).catch(t=>{console.log("fail to submit data",t),n(e)})})}getLastData(){return this.lastData}getChanelName(e,t,n){return fetch("".concat(e===s._B.WEIGH?s.Ts:s.mu,"?sid=").concat(t),{method:"get",headers:{"Content-Type":"text/plain"}}).then(async e=>{let t=await e.json();if(t.error_code==o.jK.Success){let e=N.aesDecryptUseKey(n,t.data);if(e.status===o.o2.Success)return e.info.channelName}throw Error("fetch channel stt: ".concat(t.error_code," - ").concat(t.message))}).catch(e=>{throw console.log("fail to get chanel name",e),e})}submitWeighData(e){return fetch(s.JE+"?sid=".concat(this.sessionId),{method:"post",headers:{"Content-Type":"text/plain"},body:N.aesEncrypt({subId:501,weigh:e})}).then(async e=>{let t=await e.json();if(console.log("submitWeighData done: ",t.error_code,t.message),t.error_code==o.jK.Success)return!0;throw Error("fail: "+t.error_code)}).catch(e=>(c.Z.show(i.Z.instance().text(r.d.ERR_RETRY)||"",2e3),console.error("submitWeighData err: ",e),!1))}constructor(){this.endpoint="",this.sessionId=""}}},2524:function(e,t,n){"use strict";var s,i;n.d(t,{N:function(){return s}}),(i=s||(s={}))[i.Success=0]="Success",i[i.Duplicate=1]="Duplicate",i[i.NoSession=2]="NoSession",i[i.InvalidItem=3]="InvalidItem",i[i.ItemNotFound=4]="ItemNotFound",i[i.Error=5]="Error"},54:function(e,t){"use strict";class n{setExecutor(e){this.excutor=e}show(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700;this.excutor(e),setTimeout(()=>{this.excutor("")},t)}constructor(){}}let s=new n;t.Z=s},4401:function(e,t,n){"use strict";var s,i,r,c,o,a;n.d(t,{jK:function(){return s},o2:function(){return r},xY:function(){return i}}),(c=s||(s={}))[c.Success=0]="Success",c[c.InvalidKey=1]="InvalidKey",c[c.PermissionDenied=2]="PermissionDenied",c[c.InvalidAuth=3]="InvalidAuth",c[c.AccountExists=4]="AccountExists",c[c.SessionNotFound=5]="SessionNotFound",c[c.InvalidPayload=6]="InvalidPayload",c[c.PasswordIncorrect=7]="PasswordIncorrect",c[c.ResourceNotFound=8]="ResourceNotFound",c[c.Error=9]="Error",(o=i||(i={})).EXPORT="EXPORT",o.WEIGH="WEIGH",o.NO_SESSION="NO_SESSION",(a=r||(r={}))[a.Success=0]="Success",a[a.NoSession=2]="NoSession"},7808:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var s=n(6463);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=new URLSearchParams((0,s.useSearchParams)());return t.reduce((e,t)=>{let n=i.get(t)||"";return e[t]=n,e},{})}},3957:function(e,t,n){"use strict";n.d(t,{Jk:function(){return S},ZA:function(){return u},ns:function(){return N},uZ:function(){return d},y5:function(){return a},yL:function(){return o}});var s=n(9441),i=n(6202),r=n(2524);(0,s.cn)({key:"host",default:{connected:!1}});let c={status:r.N.Success,exportId:"1",info:{id:"1",packageSeries:"packageSeries",po:"po",packageId:"packageId"}},o=(0,s.cn)({key:"item",default:c}),a=(0,s.cn)({key:"noti",default:i.d.GUIDE_SCAN}),S=(0,s.cn)({key:"toast",default:""}),u=(0,s.cn)({key:"popup",default:""}),N=(0,s.cn)({key:"channel",default:""}),d=(0,s.cn)({key:"weighState",default:!1})},1466:function(e,t,n){"use strict";n.d(t,{default:function(){return E}});var s=n(7437),i=n(2265),r=n(6648),c=n(7343),o=n(9441),a=n(3957),S=n(1066),u=n(9084),N=n(7808),d=n(6202),E=e=>{let t=function(e){let[t,n]=(0,o.FV)(a.ns),{sid:s,ek:r}=(0,N.b)(u.uT,u.zm),c=u._B.HOME;return window.location.pathname.includes(u._B.EXPORT)&&(c=u._B.EXPORT),window.location.pathname.includes(u._B.WEIGH)&&(c=u._B.WEIGH),(0,i.useEffect)(()=>{if("/"==window.location.pathname){n(d.d.SESSION_EXPIRE);return}let e=()=>{"/"!==window.location.pathname&&window.location.replace("/")};if(!s){e();return}S.U.instance().getChanelName(c,s,r).then(e=>{n(e)}).catch(t=>{e()})},[s,r]),t}(e.tag);return e.connected?(0,s.jsxs)("div",{className:"flex flex-none justify-center items-center mb-2 h-8 rounded w-full bg-[#E5EFFF]",children:[e.tag&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{style:"text-[#5198FF] font-semibold",textKey:e.tag}),(0,s.jsx)("div",{className:"w-0.5 h-5 bg-[#969595] mx-2"})]}),(0,s.jsx)("span",{className:"text-[#5198FF] max-w-52 truncate",children:(0,s.jsx)(c.Z,{style:"",textKey:t})}),(0,s.jsx)(r.default,{className:"px-1 w-6",src:"/tick.svg",width:40,height:40,alt:"connected-icon"})]}):(0,s.jsxs)("div",{className:"flex flex-none justify-center items-center mb-2 h-8 rounded w-full bg-[#FFF9D0]",children:[(0,s.jsx)("span",{className:"text-red-500",children:(0,s.jsx)(c.Z,{style:"",textKey:t})}),(0,s.jsx)(r.default,{className:"px-1 w-6",src:"/warning.png",width:40,height:40,alt:"connected-icon"})]})}},7343:function(e,t,n){"use strict";var s=n(7437);n(2265);var i=n(8571);t.Z=e=>{let{style:t,textKey:n}=e;return(0,s.jsx)("div",{className:t,children:i.Z.instance().text(n)||n})}}},function(e){e.O(0,[691,389,110,971,23,744],function(){return e(e.s=4951)}),_N_E=e.O()}]);