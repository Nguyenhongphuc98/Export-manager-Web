(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[911],{2480:function(){},9084:function(e,t,n){"use strict";n.d(t,{mu:function(){return d},Ts:function(){return S},zm:function(){return u},ST:function(){return N},be:function(){return a},_B:function(){return r},Np:function(){return E},KB:function(){return f},uT:function(){return l},JE:function(){return h},Wn:function(){return _}});var s,r,c="http://157.245.196.187:8080/api/v1/",i=n(6202),o=n(2524);let a="lang",u="ek",l="sid",S=c+"scanner/connectw",d=c+"scanner/connecte",N=c+"scanner/export",h=c+"scanner/uweigh";(s=r||(r={})).HOME="/",s.EXPORT="/export",s.WEIGH="/weigh";let E=new Map([[o.N.Success,i.d.SCAN_SUCCESS],[o.N.Duplicate,i.d.SCAN_DUP],[o.N.InvalidItem,i.d.SCAN_INVALID],[o.N.NoSession,i.d.SCAN_NO_SESSION],[o.N.ItemNotFound,i.d.SCAN_NO_ITEM]]),f=new Map([[o.N.Success,i.d.SCAN_SUCCESS_MESSAGE],[o.N.Duplicate,i.d.SCAN_DUP_MESSAGE],[o.N.InvalidItem,i.d.SCAN_INVALID_MESSAGE],[o.N.NoSession,i.d.SCAN_NO_SESSION_MESSAGE],[o.N.ItemNotFound,i.d.SCAN_NO_ITEM_MESSAGE]]),_=new Set(["packageSeries","po","packageId"])},8571:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}}),(s=r||(r={})).VietNam="vi",s.English="en",s.Chinese="zh";var s,r,c=n(6202);let i="d_l_k";class o{static instance(){return this._instance||(this._instance=new this),this._instance}setLang(e){e&&(this.activeLang=e,localStorage.setItem(i,e))}text(e){if(c.j[e])return c.j[e][this.activeLang];console.info("use invalid text key.",e)}constructor(){let e=localStorage.getItem(i);this.activeLang=e||r.VietNam}}},6202:function(e,t,n){"use strict";var s,r;n.d(t,{d:function(){return s},j:function(){return c}}),(r=s||(s={})).EMPTY="",r.SESSION_EXPIRE="SESSION_EXPIRE",r.GUIDE_SCAN="GUI_SCAN",r.EXPORT="EXPORT",r.WEIGH="WEIGH",r.SCAN_SUCCESS="SCAN_SUCCESS",r.SCAN_DUP="SCAN_DUP",r.SCAN_INVALID="SCAN_INVALID",r.SCAN_NO_SESSION="SCAN_NO_SESSION",r.SCAN_NO_ITEM="SCAN_NO_ITEM",r.SCAN_SUCCESS_MESSAGE="SCAN_SUCCESS_MESSAGE",r.SCAN_DUP_MESSAGE="SCAN_DUP_MESSAGE",r.SCAN_INVALID_MESSAGE="SCAN_INVALID_MESSAGE",r.SCAN_NO_SESSION_MESSAGE="SCAN_NO_SESSION_MESSAGE",r.SCAN_NO_ITEM_MESSAGE="SCAN_NO_ITEM_MESSAGE",r.WEIGH_FIELD_NAME="WEIGH_FIELD_NAME",r.SUBMIT="SUBMIT",r.ERR_RETRY="ERR_RETRY";let c={SESSION_EXPIRE:{vi:"Phi\xean xử l\xfd đ\xe3 hết hạn.",en:"The session has expired.",zh:"会话已过期"},GUI_SCAN:{vi:"Đưa camera tới QR code để qu\xe9t.",en:"Scan the QR code with your camera.",zh:"使用相机扫描 QR 码"},WEIGH:{vi:"C\xc2N H\xc0NG",en:"WEIGH",zh:"衡量"},EXPORT:{vi:"XUẤT H\xc0NG",en:"EXPORT",zh:"輸出"},SCAN_SUCCESS:{vi:"QU\xc9T TH\xc0NH C\xd4NG",en:"SCAN SUCCESS",zh:"掃描碼成功"},SCAN_DUP:{vi:"QU\xc9T TR\xd9NG",en:"Duplicated",zh:"重複的"},SCAN_INVALID:{vi:"QU\xc9T SAI PHI\xcaN",en:"SCAN_INVALID",zh:"SCAN_INVALID"},SCAN_NO_SESSION:{vi:"KH\xd4NG C\xd3 PHI\xcaN",en:"No session",zh:"沒有會話處理"},SCAN_NO_ITEM:{vi:"SANE PHẨM KH\xd4NG TỒN TẠI",en:"The item does not exist",zh:"此產品不存在"},SCAN_SUCCESS_MESSAGE:{vi:"Qu\xe9t th\xe0nh c\xf4ng",en:"SCAN SUCCESS",zh:"掃描碼成功"},SCAN_DUP_MESSAGE:{vi:"Sản phẩm n\xe0y đ\xe3 được qu\xe9t!",en:"This item has already been scanned",zh:"該商品已掃描"},SCAN_INVALID_MESSAGE:{vi:"Sản phẩm n\xe0y kh\xf4ng nằm trong phi\xean",en:"This product is not available in session!",zh:"該產品在會話中不可用"},SCAN_NO_SESSION_MESSAGE:{vi:"Phi\xean xử l\xfd n\xe0y kh\xf4ng tồn tại!",en:"Session does not exist",zh:"會話不存在"},SCAN_NO_ITEM_MESSAGE:{vi:"Sản phẩm n\xe0y kh\xf4ng tồn tại!",en:"This item does not exist",zh:"此產品不存在"},WEIGH_FIELD_NAME:{vi:"C\xe2n nặng",en:"weight",zh:"重量"},SUBMIT:{vi:"Nhập",en:"Submit",zh:"輸入資料"},ERR_RETRY:{vi:"C\xf3 lỗi, thử lại sau",en:"Error, retry later",zh:"錯誤，稍後重試"}}},2544:function(e,t){"use strict";class n{setExecutor(e){this.excutor=e}show(e){this.excutor(e)}close(){this.excutor("")}constructor(){}}let s=new n;t.Z=s},1066:function(e,t,n){"use strict";n.d(t,{U:function(){return N}});var s=n(9084),r=n(8571),c=n(6202),i=n(54),o=n(4401);let{AES:a,enc:u}=n(8110);class l{init(e){this.encryptKey=e}aesEncrypt(e){return a.encrypt(JSON.stringify(e),this.encryptKey).toString()}aesDecrypt(e){return 0==Object.keys(e).length?e:JSON.parse(a.decrypt(e,this.encryptKey).toString(u.Utf8))}aesEncryptUseKey(e,t){return a.encrypt(JSON.stringify(t),e).toString()}aesDecryptUseKey(e,t){return JSON.parse(a.decrypt(t,e).toString(u.Utf8))}constructor(){this.encryptKey=""}}let S=new l;var d=n(2524);class N{static instance(){return this._instance||(this._instance=new this),this._instance}initSession(e,t,n){this.endpoint=e,this.sessionId=t,S.init(n)}getFullData(e){return new Promise(t=>{let n=e=>{this.lastData=e,t(e)};return""==this.endpoint?(console.log("endpoint not set, use default"),n(e)):fetch(this.endpoint+"?sid=".concat(this.sessionId),{method:"post",headers:{"Content-Type":"text/plain"},body:S.aesEncrypt({subId:e})}).then(async e=>{let t=await e.json(),s=t.error_code==o.jK.SessionNotFound?t.data:S.aesDecrypt(t.data);switch(s.status){case d.N.Success:case d.N.Duplicate:case d.N.InvalidItem:case d.N.ItemNotFound:n(s);break;case d.N.NoSession:throw Error("No session")}}).catch(t=>{console.log("fail to submit data",t),n(e)})})}getLastData(){return this.lastData}getChanelName(e,t,n){return fetch("".concat(e===s._B.WEIGH?s.Ts:s.mu,"?sid=").concat(t),{method:"get",headers:{"Content-Type":"text/plain"}}).then(async e=>{let t=await e.json();if(t.error_code==o.jK.Success){let e=S.aesDecryptUseKey(n,t.data);if(e.status===o.o2.Success)return e.info.channelName}throw Error("fetch channel stt: ".concat(t.error_code," - ").concat(t.message))}).catch(e=>{throw console.log("fail to get chanel name",e),e})}submitWeighData(e){return fetch(s.JE+"?sid=".concat(this.sessionId),{method:"post",headers:{"Content-Type":"text/plain"},body:S.aesEncrypt({subId:501,weigh:e})}).then(async e=>{let t=await e.json();if(console.log("submitWeighData done: ",t.error_code,t.message),t.error_code==o.jK.Success)return!0;throw Error("fail: "+t.error_code)}).catch(e=>(i.Z.show(r.Z.instance().text(c.d.ERR_RETRY)||"",2e3),console.error("submitWeighData err: ",e),!1))}constructor(){this.endpoint="",this.sessionId=""}}},2524:function(e,t,n){"use strict";var s,r;n.d(t,{N:function(){return s}}),(r=s||(s={}))[r.Success=0]="Success",r[r.Duplicate=1]="Duplicate",r[r.NoSession=2]="NoSession",r[r.InvalidItem=3]="InvalidItem",r[r.ItemNotFound=4]="ItemNotFound",r[r.Error=5]="Error"},54:function(e,t){"use strict";class n{setExecutor(e){this.excutor=e}show(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700;this.excutor(e),setTimeout(()=>{this.excutor("")},t)}constructor(){}}let s=new n;t.Z=s},4401:function(e,t,n){"use strict";var s,r,c,i,o,a;n.d(t,{jK:function(){return s},o2:function(){return c},xY:function(){return r}}),(i=s||(s={}))[i.Success=0]="Success",i[i.InvalidKey=1]="InvalidKey",i[i.PermissionDenied=2]="PermissionDenied",i[i.InvalidAuth=3]="InvalidAuth",i[i.AccountExists=4]="AccountExists",i[i.SessionNotFound=5]="SessionNotFound",i[i.InvalidPayload=6]="InvalidPayload",i[i.PasswordIncorrect=7]="PasswordIncorrect",i[i.ResourceNotFound=8]="ResourceNotFound",i[i.Error=9]="Error",(o=r||(r={})).EXPORT="EXPORT",o.WEIGH="WEIGH",o.NO_SESSION="NO_SESSION",(a=c||(c={}))[a.Success=0]="Success",a[a.NoSession=2]="NoSession"},7808:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var s=n(6463);function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=new URLSearchParams((0,s.useSearchParams)());return t.reduce((e,t)=>{let n=r.get(t)||"";return e[t]=n,e},{})}},3957:function(e,t,n){"use strict";n.d(t,{Jk:function(){return u},ZA:function(){return l},ns:function(){return S},uZ:function(){return d},y5:function(){return a},yL:function(){return o}});var s=n(9441),r=n(6202),c=n(2524);(0,s.cn)({key:"host",default:{connected:!1}});let i={status:c.N.Success,exportId:"1",info:{id:"1",packageSeries:"packageSeries",po:"po",packageId:"packageId"}},o=(0,s.cn)({key:"item",default:i}),a=(0,s.cn)({key:"noti",default:r.d.GUIDE_SCAN}),u=(0,s.cn)({key:"toast",default:""}),l=(0,s.cn)({key:"popup",default:""}),S=(0,s.cn)({key:"channel",default:""}),d=(0,s.cn)({key:"weighState",default:!1})},1466:function(e,t,n){"use strict";n.d(t,{default:function(){return N}});var s=n(7437),r=n(2265),c=n(6648),i=n(7343),o=n(9441),a=n(3957),u=n(1066),l=n(9084),S=n(7808),d=n(6202),N=e=>{let t=function(e){let[t,n]=(0,o.FV)(a.ns),{sid:s,ek:c}=(0,S.b)(l.uT,l.zm),i=l._B.HOME;return window.location.pathname.includes(l._B.EXPORT)&&(i=l._B.EXPORT),window.location.pathname.includes(l._B.WEIGH)&&(i=l._B.WEIGH),(0,r.useEffect)(()=>{if("/"==window.location.pathname){n(d.d.SESSION_EXPIRE);return}let e=()=>{"/"!==window.location.pathname&&window.location.replace("/")};if(!s){e();return}u.U.instance().getChanelName(i,s,c).then(e=>{n(e)}).catch(t=>{e()})},[s,c]),t}(e.tag);return e.connected?(0,s.jsxs)("div",{className:"flex flex-none justify-center items-center mb-2 h-8 rounded w-full bg-[#E5EFFF]",children:[e.tag&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{style:"text-[#5198FF] font-semibold",textKey:e.tag}),(0,s.jsx)("div",{className:"w-0.5 h-5 bg-[#969595] mx-2"})]}),(0,s.jsx)("span",{className:"text-[#5198FF] max-w-52 truncate",children:(0,s.jsx)(i.Z,{style:"",textKey:t})}),(0,s.jsx)(c.default,{className:"px-1 w-6",src:"/tick.svg",width:40,height:40,alt:"connected-icon"})]}):(0,s.jsxs)("div",{className:"flex flex-none justify-center items-center mb-2 h-8 rounded w-full bg-[#FFF9D0]",children:[(0,s.jsx)("span",{className:"text-red-500",children:(0,s.jsx)(i.Z,{style:"",textKey:t})}),(0,s.jsx)(c.default,{className:"px-1 w-6",src:"/warning.png",width:40,height:40,alt:"connected-icon"})]})}},7343:function(e,t,n){"use strict";var s=n(7437);n(2265);var r=n(8571);t.Z=e=>{let{style:t,textKey:n}=e;return(0,s.jsx)("div",{className:t,children:r.Z.instance().text(n)||n})}},9378:function(e,t,n){"use strict";var s=n(7437);n(2265);var r=n(9441),c=n(3957),i=n(7343);t.Z=()=>{let e=(0,r.sJ)(c.y5);return null==e||""==e?null:(0,s.jsx)("div",{className:"flex justify-center px-6 pt-2 w-full rounded",children:(0,s.jsx)("span",{className:"rounded h-fit px-6 py-2 bg-[#FFF9D0] text-[#FF6A6A] text-center",children:(0,s.jsx)(i.Z,{style:"",textKey:e})})})}},6864:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var s=n(7437),r=n(2265),c=n(6648),i=n(7343),o=n(9441),a=n(3957),u=n(1066),l=n(5903),S=n(9084),d=n(6202),N=n(7808),h=n(2524),E=n(2544),f=r.memo(e=>{let t,{submitTo:n,footerr:f}=e,_=function(e){let[t,n]=(0,o.FV)(a.yL),[s,c]=(0,o.FV)(a.y5),[i,f]=(0,o.FV)(a.uZ),{sid:_,ek:I}=(0,N.b)(S.uT,S.zm);return(0,r.useEffect)(()=>{let t=()=>{window.location.replace("/")};if(!_||!I){t();return}u.U.instance().initSession(e,_,I),function(e){let t=null;new l.t2("reader").start({facingMode:"environment"},{fps:10,qrbox:(e,t)=>({width:e,height:t})},function(n,s){if(t==n){console.log("duplicate: ",n);return}console.log("will process",n),t=n;try{let t=JSON.parse(n);console.log("did process",t),e(t)}catch(t){e(n),console.error("parse error: ",t)}},function(e,t){console.error("scan error: ",e)}).catch(e=>{console.error("start error",e)})}(e=>{u.U.instance().getFullData(e).then(e=>{c(d.d.EMPTY),n(e),f(!1),e.status!==h.N.Success&&E.Z.show(S.KB.get(e.status)||"")}).catch(e=>{console.error("scan error: ",e),t()})})},[]),t}(n);if(!_)return null;let I=S.Np.get(_.status)||"";return(0,s.jsxs)("div",{className:"flex flex-col w-11/12 bg-white justify-center m-4",children:[(0,s.jsxs)("div",{className:"flex  mb-0.5 bg-[#EEEEEE] p-1 rounded-t-md",children:[(0,s.jsx)(c.default,{src:"/success-green.png",alt:"success icon",width:24,height:24}),(0,s.jsx)("span",{className:"mx-1 text-[#00C578] font-semibold",children:(0,s.jsx)(i.Z,{style:"",textKey:I})})]}),(0,s.jsx)("div",{className:" bg-[#F8F8F8]",children:_?(t=_.info,(0,s.jsxs)("div",{className:"flex flex-col w-full h-full px-4 overflow-y-auto",style:{maxHeight:"30vh"},children:[t&&Object.keys(t).map(e=>{if(!S.Wn.has(e))return null;let n=t[e];return(0,s.jsxs)("div",{className:"flex w-full mt-1.5 border-b",children:[(0,s.jsx)("div",{className:"flex w-3/6 text-start text-[#7B7B7D] font-semibold items-center truncate",children:(0,s.jsx)("span",{className:"truncate",children:e})}),(0,s.jsx)("div",{className:"flex w-3/6 font-semibold items-center text-[#001A33]",children:(0,s.jsx)("span",{className:"truncate",children:n})})]},e)}).filter(e=>null!==e),(0,s.jsx)("div",{className:"flex w-full mt-1.5 h-6"},"empty row")]})):null}),_.status==h.N.Success&&f?f():null]})})}}]);